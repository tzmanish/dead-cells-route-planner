(function(){let e=document.createElement(`link`).relList;if(e&&e.supports&&e.supports(`modulepreload`))return;for(let e of document.querySelectorAll(`link[rel="modulepreload"]`))n(e);new MutationObserver(e=>{for(let t of e)if(t.type===`childList`)for(let e of t.addedNodes)e.tagName===`LINK`&&e.rel===`modulepreload`&&n(e)}).observe(document,{childList:!0,subtree:!0});function t(e){let t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),e.crossOrigin===`use-credentials`?t.credentials=`include`:e.crossOrigin===`anonymous`?t.credentials=`omit`:t.credentials=`same-origin`,t}function n(e){if(e.ep)return;e.ep=!0;let n=t(e);fetch(e.href,n)}})();function e(){let e=document.createElement(`header`);return e.className=`bg-dc-header shadow-dc h-[60px]`,e.innerHTML=`
      <div class="mx-auto h-full px-4">
        <div class="flex justify-between items-end h-full">
          <div class="flex items-baseline gap-0 font-title font-bold text-5xl">
            Route
            <img src="/dead-cells-route-planner/logo.svg" alt="Dead Cells Route Planner Logo" class="h-8"/>
            Planner
          </div>
        </div>
      </div>
    `,e}const t=new class{listeners;constructor(){this.listeners=new Map}on(e,t){return this.listeners.has(e)||this.listeners.set(e,new Set),this.listeners.get(e).add(t),()=>{let n=this.listeners.get(e);n&&(n.delete(t),n.size===0&&this.listeners.delete(e))}}emit(e,t){let n=this.listeners.get(e);n&&n.forEach(e=>{e(t)})}clear(e,t){if(e)if(t){let n=this.listeners.get(e);n&&(n.delete(t),n.size===0&&this.listeners.delete(e))}else this.listeners.delete(e);else this.listeners.clear()}},n={BC0:0,BC1:1,BC2:2,BC3:3,BC4:4},r=[{code:`FF`,name:`Fatal Falls`,key:`FatalFalls`,color:`#FFBE32`},{code:`RotG`,name:`Rise of the Giant`,key:`RiseOfTheGiant`,color:`#52f1f4`},{code:`RtC`,name:`Return to Castlevania`,key:`ReturnToCastlevania`,color:`#f02934`},{code:`TBS`,name:`The Bad Seed`,key:`TheBadSeed`,color:`#82C936`},{code:`TQatS`,name:`The Queen and the Sea`,key:`TheQueenAndTheSea`,color:`#B573E3`}],i=Object.fromEntries(r.map(e=>[e.key,e.code]));let a=function(e){return e.Standard=`standard`,e.Optional=`optional`,e.Boss=`boss`,e}({});const o={L1:1,L2:2,O1:2.5,L3:3,B1:3.5,L4:4,L5:5,B2:5.5,L6:6,B3:6.5,L7:7,B4:8},s=Object.fromEntries(Object.entries(o).map(([e,t])=>{let n=``;switch(e.charAt(0)){case`L`:n=`Level`;break;case`O`:n=`Optional`;break;case`B`:n=`Boss`;break}return[t,`${n} ${e.slice(1)}`]})),c=new class{currentLevel;constructor(){this.currentLevel=o.L1}set(e){this.currentLevel=e}getCurrent(){return this.currentLevel}getAll(){return Object.values(o)}getName(e){return s[e]}};var l=class{biomeMap;levelMap;constructor(e){this.biomeMap=new Map,this.levelMap=new Map,c.getAll().forEach(e=>this.levelMap.set(e,new Set)),e.forEach(e=>{this.biomeMap.set(e.name,e),this.levelMap.get(e.level)?.add(e.name)})}getAllBiomes(){return[...this.biomeMap.values()].map(e=>e.name)}getBiomeObject(e){return this.biomeMap.get(e)}getBiomesByLevel(e){return[...this.levelMap.get(e)||new Set]}getBiomesByDLC(e){return[...this.biomeMap.values()].filter(t=>t.dlc===e).map(e=>e.name)}getWikiURL(e){return this.getBiomeObject(e)?.wiki||``}getImageURL(e){return this.getBiomeObject(e)?.image||`/dead-cells-route-planner/biome_placeholder.svg`}},u=null;async function d(){return u||(u=fetch(`/dead-cells-route-planner/biomes.json`).then(e=>{if(!e.ok)throw Error(`HTTP ${e.status}`);return e.json()}).then(e=>new l(e)).catch(e=>{throw u=null,console.error(`Failed to load biome data:`,e),e}),u)}const f=await d(),p=new class{STORAGE_KEYS={ENABLED_DLCS:`dead-cells-enabled-dlcs`,DIFFICULTY:`dead-cells-difficulty`,SPOILER_PROTECTION:`dead-cells-spoiler-protection`,VIEW_STRATEGY:`dead-cells-planner-view`};saveEnabledDLCs(e){try{localStorage.setItem(this.STORAGE_KEYS.ENABLED_DLCS,JSON.stringify(e))}catch(e){console.error(`Failed to save enabled DLCs to localStorage:`,e)}}loadEnabledDLCs(){try{let e=localStorage.getItem(this.STORAGE_KEYS.ENABLED_DLCS);return e?JSON.parse(e):null}catch(e){return console.error(`Failed to load enabled DLCs from localStorage:`,e),null}}saveDifficulty(e){try{localStorage.setItem(this.STORAGE_KEYS.DIFFICULTY,e)}catch(e){console.error(`Failed to save difficulty to localStorage:`,e)}}loadDifficulty(){try{return localStorage.getItem(this.STORAGE_KEYS.DIFFICULTY)}catch(e){return console.error(`Failed to load difficulty from localStorage:`,e),null}}saveSpoilerProtection(e){try{localStorage.setItem(this.STORAGE_KEYS.SPOILER_PROTECTION,JSON.stringify(e))}catch(e){console.error(`Failed to save spoiler protection to localStorage:`,e)}}loadSpoilerProtection(){try{let e=localStorage.getItem(this.STORAGE_KEYS.SPOILER_PROTECTION);return e===null?null:JSON.parse(e)}catch(e){return console.error(`Failed to load spoiler protection from localStorage:`,e),null}}saveViewStrategy(e){try{localStorage.setItem(this.STORAGE_KEYS.VIEW_STRATEGY,JSON.stringify(e))}catch(e){console.error(`Failed to save view strategy to localStorage:`,e)}}loadViewStrategy(){try{let e=localStorage.getItem(this.STORAGE_KEYS.VIEW_STRATEGY);return e===null?null:JSON.parse(e)}catch(e){return console.error(`Failed to load view strategy from localStorage:`,e),null}}clearAll(){try{Object.values(this.STORAGE_KEYS).forEach(e=>{localStorage.removeItem(e)})}catch(e){console.error(`Failed to clear localStorage:`,e)}}},m=new class{currentDifficulty;constructor(){this.loadFromStorage()}loadFromStorage(){let e=p.loadDifficulty();if(e!==null){let t=parseInt(e,10),r=Object.values(n);!isNaN(t)&&r.includes(t)?this.currentDifficulty=t:this.currentDifficulty=n.BC0}else this.currentDifficulty=n.BC0}saveToStorage(){p.saveDifficulty(this.currentDifficulty.toString())}set(e){this.currentDifficulty=e,this.saveToStorage()}getCurrent(){return this.currentDifficulty}getAll(){return Object.values(n)}getName(e){return`${e} BC`}},h=new class{enabledDlcs;constructor(){this.loadFromStorage()}loadFromStorage(){let e=p.loadEnabledDLCs();e===null?this.enabledDlcs=new Set(this.getAll()):this.enabledDlcs=new Set(e)}saveToStorage(){let e=[...this.enabledDlcs].filter(e=>e!==null);p.saveEnabledDLCs(e)}enable(e){e!==null&&(this.enabledDlcs.add(e),this.saveToStorage())}disable(e){e!==null&&(this.enabledDlcs.delete(e),this.saveToStorage())}getAll(){return Object.values(i)}getEnabled(){return[...this.enabledDlcs]}getShortName(e){return e===null?``:r.find(t=>t.code===e).code}getName(e){return e===null?``:r.find(t=>t.code===e).name}getColor(e){return e===null?``:r.find(t=>t.code===e).color}getDom(e){let t=document.createElement(`span`);return t.className=`font-bold`,t.style.color=this.getColor(e),t.textContent=this.getShortName(e),t.title=`${this.getName(e)} DLC`,t}isEnabled(e){return e===null?!0:this.enabledDlcs.has(e)}isDisabled(e){return!this.isEnabled(e)}filterByEnabledDLCs(e){return e.filter(e=>this.isEnabled(e.dlc))}},g=new class{nextLevelMap;commulativeScrollCountMap;constructor(){this.nextLevelMap=new Map,this.commulativeScrollCountMap=new Map,this.recalculate()}getNextBiome(e){return this.nextLevelMap.get(e)}scrollCount(e){return this.commulativeScrollCountMap.get(e)}flattenCount(e){return e.power+e.cursed+e.dual+e.fragment/4}flatCommulativeScrollCount(e){let t=this.scrollCount(e);return t?this.flattenCount(t):0}flatCommulativeScrollCount_weighted(e){let t=this.scrollCount(e);return t?this.flattenCount(t):0}recalculate(){this.nextLevelMap.clear(),this.commulativeScrollCountMap.clear();let e=c.getAll(),t=m.getCurrent();for(let n=e.length-1;n>=0;n--){let r=f.getBiomesByLevel(e[n]).map(e=>f.getBiomeObject(e)).filter(e=>e!==void 0);h.filterByEnabledDLCs(r).forEach(e=>{if(e){let n=e.exits[t].map(e=>f.getBiomeObject(e)).filter(e=>e!==void 0),r=h.filterByEnabledDLCs(n),i=null;r.length>0&&(i=r.reduce((e,t)=>t&&(!e||this.flatCommulativeScrollCount_weighted(t.name)>this.flatCommulativeScrollCount_weighted(e.name))?t:e));let a=e.scrolls[t],o=i?this.commulativeScrollCountMap.get(i.name):null;o&&(a={power:a.power+o.power,dual:a.dual+o.dual,fragment:a.fragment+o.fragment,cursed:+(a.cursed+o.cursed).toFixed(2)}),i&&this.nextLevelMap.set(e.name,i.name),this.commulativeScrollCountMap.set(e.name,a)}})}}},_=new class{spoilerProtectionEnabled;constructor(){this.loadFromStorage()}loadFromStorage(){let e=p.loadSpoilerProtection();e===null?this.spoilerProtectionEnabled=!0:this.spoilerProtectionEnabled=e}saveToStorage(){p.saveSpoilerProtection(this.spoilerProtectionEnabled)}isEnabled(){return this.spoilerProtectionEnabled}isDisabled(){return!this.spoilerProtectionEnabled}enable(){this.spoilerProtectionEnabled=!0,this.saveToStorage()}disable(){this.spoilerProtectionEnabled=!1,this.saveToStorage()}mask(e){if(this.isDisabled()||!e.is_spoiler)return e;let t=JSON.parse(JSON.stringify(e));return t.name=t.name.replace(/./g,`*`),t}};function v(e){return`linear-gradient(rgba(0,0,0,0.8), rgba(0,0,0,0.8)), url(${e})`}var y=class{routePanelElement;breadcrumb;choicePanel;biomeChoiceDomElements=new Map;biomeBreadcrumbDomElements=new Map;popper;refreshHandler=()=>this.refresh();constructor(){this.routePanelElement=document.createElement(`div`),this.routePanelElement.className=`p-4 relative overflow-hidden`,this.popper=document.createElement(`div`),this.popper.className=`fixed z-1000 w-auto h-auto bg-black/60 p-2 text-xs text-white`,this.popper.hidden=!0,this.routePanelElement.appendChild(this.popper),this.breadcrumb=document.createElement(`div`),this.breadcrumb.className=`flex flex-wrap`,this.choicePanel=document.createElement(`div`),this.choicePanel.className=`flex flex-wrap justify-center p-4`;let e=document.createElement(`button`);e.title=`Reset`,e.className=`icon-[majesticons--reload-circle] m-0 p-0 text-5xl fixed bottom-[120px] right-[80px] z-100 btn-dc-primary`,e.onclick=this.refreshHandler,this.routePanelElement.appendChild(e),this.routePanelElement.appendChild(this.breadcrumb),this.routePanelElement.appendChild(this.choicePanel),this.reset()}createBiomeChoiceDom(e,t){let n=this.biomeChoiceDomElements.get(e);if(n)return n;let r=100*(598/168),i=document.createElement(`button`),o=f.getImageURL(e);i.className=`p-2 m-1 flex flex-col relative items-center justify-center gap-2 bg-center bg-no-repeat z-10 bg-[length:100%_100%] enabled:hover:bg-[length:110%_110%] enabled:cursor-pointer disabled:opacity-50 transition-[background-size] duration-400 ease-out active:border`,i.style.height=`100px`,i.style.width=`${r}px`,i.style.minWidth=`${r}px`,i.style.backgroundImage=`url(/dead-cells-route-planner/biome_placeholder.svg)`;let s=new Image;s.src=o,s.onload=()=>i.style.backgroundImage=v(o);let c=f.getBiomeObject(e),l=m.getCurrent(),u=document.createElement(`h2`);u.className=`font-bold text-lg`;let d=document.createElement(`span`);d.className=`has-info`,d.textContent=c?_.mask(c).name:e,d.title=c?.desc[Math.floor(Math.random()*c.desc.length)]||e;let p=document.createElement(`a`);p.className=`link-dc ml-1 icon-[majesticons--open]`,p.href=f.getWikiURL(e),p.title=`wiki`,p.target=`_blank`,u.replaceChildren(d,p);let y=document.createElement(`div`);y.className=`flex gap-2 text-base`;let b=c?.scrolls[l],x=document.createElement(`span`),S=document.createElement(`span`);S.className=`icon-[majesticons--scroll]`;let C=document.createElement(`span`);C.textContent=b?`${Math.floor(g.flattenCount(b))}`:`-`,C.className=`has-info`,x.replaceChildren(S,C),x.title=`Scrolls in ${e}: ${b?`${b.power} Power + ${b.cursed} Cursed + ${b.dual} Dual + ${b.fragment} Fragments`:`data unavailable`}`;let w=g.scrollCount(e),T=document.createElement(`span`),E=document.createElement(`span`);E.className=`icon-[majesticons--scroll-text]`;let D=document.createElement(`span`);D.textContent=w?`${Math.floor(g.flattenCount(w))}`:`-`,D.className=`has-info`,T.replaceChildren(E,D),T.title=`Scrolls in this Route: ${w?`${w.power} Power + ${w.cursed} Cursed + ${w.dual} Dual + ${w.fragment} Fragments`:`data unavailable`}`,y.replaceChildren(x,T);let O=document.createElement(`div`);O.className=`absolute top-0 left-0 m-1 flex`;let k=document.createElement(`div`);k.className=`absolute top-0 right-0 flex`;let A=c.dlc||null;if(A!==null){let e=h.getDom(A);e.classList.add(`text-xs`,`bg-black`,`px-2`),k.appendChild(e)}if((c?.type||a.Standard)==a.Boss){let e=document.createElement(`span`);e.className=`icon-[majesticons--skull] bg-dc-red`,e.title=`Boss`,O.appendChild(e)}if(h.isDisabled(A)){let e=document.createElement(`span`);e.className=`icon-[majesticons--lock] bg-dc-red`,e.title=`Locked DLC`,O.appendChild(e)}if(t){let e=document.createElement(`span`);e.className=`bg-dc-red text-xs px-1 rounded-full`,e.title=`${t}BC required`,e.textContent=`${t}BC`,O.appendChild(e)}return i.replaceChildren(k,O,u,y),i.onclick=()=>{this.addToBreadcrumb(e),this.populateChoices(e)},c?.dlc&&h.isDisabled(c.dlc)&&(i.disabled=!0),t&&t>m.getCurrent()&&(i.disabled=!0),this.biomeChoiceDomElements.set(e,i),i}addToBreadcrumb(e){let t=document.createElement(`span`);t.textContent=`>`,t.className=`px-2 text-dc-red`,this.breadcrumb.appendChild(t);let n=this.createBiomeBreadcrumbDom(e);this.breadcrumb.appendChild(n)}populateChoices(e){this.choicePanel.replaceChildren();let t=f.getBiomeObject(e);t?.exits[n.BC4].forEach(e=>{let r=t.exits[n.BC0].some(t=>t==e)?n.BC0:t.exits[n.BC1].some(t=>t==e)?n.BC1:t.exits[n.BC2].some(t=>t==e)?n.BC2:t.exits[n.BC3].some(t=>t==e)?n.BC3:n.BC4,i=this.createBiomeChoiceDom(e,r);this.choicePanel.appendChild(i)})}createBiomeBreadcrumbDom(e){let t=this.biomeBreadcrumbDomElements.get(e);if(t)return t;let n=document.createElement(`button`);return n.className=`link-dc`,n.textContent=e,n.onclick=()=>{let t=n.nextElementSibling;for(;t;){let e=t.nextElementSibling;t.remove(),t=e}this.populateChoices(e)},this.biomeBreadcrumbDomElements.set(e,n),n}reset(){let e=f.getBiomesByLevel(o.L1)[0],t=this.createBiomeBreadcrumbDom(e);this.breadcrumb.replaceChildren(t),this.populateChoices(e)}render(){return t.on(`control-panel-reset`,this.refreshHandler),requestAnimationFrame(this.refreshHandler),this.routePanelElement}refresh(){g.recalculate(),this.biomeChoiceDomElements.clear(),this.reset()}clear(){t.clear(`control-panel-reset`,this.refreshHandler)}};const b=new class{render(){let e=document.createElement(`span`);return e.textContent=`Error!!`,e.className=`flex justify-center`,e}refresh(){}clear(){}};
/*! NanoPop 2.4.2 MIT | https://github.com/Simonwep/nanopop */
var x={variantFlipOrder:{start:`sme`,middle:`mse`,end:`ems`},positionFlipOrder:{top:`tbrl`,right:`rltb`,bottom:`btrl`,left:`lrbt`},position:`bottom`,margin:8,padding:0},S=(e,t,n)=>{let{container:r,arrow:i,margin:a,padding:o,position:s,variantFlipOrder:c,positionFlipOrder:l}={container:document.documentElement.getBoundingClientRect(),...x,...n},{left:u,top:d}=t.style;t.style.left=`0`,t.style.top=`0`;let f=e.getBoundingClientRect(),p=t.getBoundingClientRect(),m={t:f.top-p.height-a,b:f.bottom+a,r:f.right+a,l:f.left-p.width-a},h={vs:f.left,vm:f.left+f.width/2-p.width/2,ve:f.left+f.width-p.width,hs:f.top,hm:f.bottom-f.height/2-p.height/2,he:f.bottom-p.height},[g,_=`middle`]=s.split(`-`),v=l[g],y=c[_],{top:b,left:S,bottom:C,right:w}=r;for(let e of v){let n=e===`t`||e===`b`,r=m[e],[a,s]=n?[`top`,`left`]:[`left`,`top`],[c,l]=n?[p.height,p.width]:[p.width,p.height],[u,d]=n?[C,w]:[w,C],[g,_]=n?[b,S]:[S,b];if(!(r<g||r+c+o>u))for(let u of y){let m=h[(n?`v`:`h`)+u];if(!(m<_||m+l+o>d)){if(m-=p[s],r-=p[a],t.style[s]=`${m}px`,t.style[a]=`${r}px`,i){let t=n?f.width/2:f.height/2,o=l/2,d=t>o,p={s:d?o:t,m:o,e:d?o:l-t},h={t:c,b:0,r:0,l:c},g=m+p[u],_=r+h[e];i.style[s]=`${g}px`,i.style[a]=`${_}px`}return e+u}}}return t.style.left=u,t.style.top=d,null},C=class{svgWrapper;init(e){this.svgWrapper=document.createElement(`div`),this.svgWrapper.className=`w-0 h-0 absolute top-0 left-0 z-100`,e.appendChild(this.svgWrapper),this.reposition(e)}clear(){this.svgWrapper?.remove()}reposition(e){if(!this.svgWrapper)return;let t=e.getBoundingClientRect();this.svgWrapper.style.transform=`translate(${-t.left-window.scrollX}px, ${-t.top-window.scrollY}px)`}reset(e){this.clear(),this.init(e)}create(e,n,r){let i=new window.LeaderLine(e,n,r),a=document.querySelector(`body > .leader-line:last-child`);a&&this.svgWrapper&&this.svgWrapper.appendChild(a),e.parentElement?.addEventListener(`scroll`,window.AnimEvent.add(()=>i.position()),!1),n.parentElement?.addEventListener(`scroll`,window.AnimEvent.add(()=>i.position()),!1),t.on(`route-panel-reset`,()=>{e.parentElement?.removeEventListener(`scroll`,window.AnimEvent.add(()=>i.position())),n.parentElement?.removeEventListener(`scroll`,window.AnimEvent.add(()=>i.position()))})}},w=null;async function T(){if(w)return w;if(window.LeaderLine&&window.AnimEvent)return w=Promise.resolve(new C),w;let e=e=>new Promise((t,n)=>{let r=document.createElement(`script`);r.src=e,r.onload=()=>t(),r.onerror=()=>n(Error(`Failed to load ${e}`)),document.head.appendChild(r)});return w=Promise.all([window.AnimEvent?Promise.resolve():e(`/dead-cells-route-planner/anim-event.min.js`),window.LeaderLine?Promise.resolve():e(`/dead-cells-route-planner/leader-line.min.js`)]).then(()=>new C).catch(e=>{throw w=null,e}),w}const E=await T();var D=class{routePanelElement;biomeDomElements=new Map;popper;resizeHandler=()=>E.reposition(this.routePanelElement);refreshHandler=()=>this.refresh();constructor(){this.routePanelElement=document.createElement(`div`),this.routePanelElement.className=`p-4 relative overflow-hidden`,this.popper=document.createElement(`div`),this.popper.className=`fixed z-1000 w-auto h-auto bg-black/60 p-2 text-xs text-white`,this.popper.hidden=!0,this.routePanelElement.appendChild(this.popper),f.getAllBiomes().forEach(e=>this.biomeDomElements.set(e,this.createBiomeDom(e))),c.getAll().forEach(e=>{let t=this.createLevelDom(e);this.routePanelElement?.appendChild(t)})}render(){return t.on(`control-panel-reset`,this.refreshHandler),window.addEventListener(`resize`,this.resizeHandler),requestAnimationFrame(this.refreshHandler),this.routePanelElement}refresh(){g.recalculate(),this.routePanelElement&&E.reset(this.routePanelElement);let e=f.getBiomesByLevel(o.L1)[0],n=this.biomeDomElements.get(e),r=g.getNextBiome(e),i=this.biomeDomElements.get(r||``);for(;r;)n&&i&&E.create(n,i,{startSocket:`bottom`,endSocket:`top`,color:`#f9cf87`,size:1.2,path:`grid`}),i?.scrollIntoView(),n=i,r=g.getNextBiome(r),i=this.biomeDomElements.get(r||``);window.scrollTo(0,0),this.biomeDomElements.forEach((e,t)=>{let n=f.getBiomeObject(t),r=m.getCurrent(),i=document.createElement(`h2`);i.className=`font-bold text-lg`;let o=document.createElement(`span`);o.className=`has-info`,o.textContent=n?_.mask(n).name:t,o.addEventListener(`mouseover`,()=>this.showPopper(o,n?.desc[Math.floor(Math.random()*n.desc.length)]||t));let s=document.createElement(`a`);s.className=`link-dc ml-1 icon-[majesticons--open]`,s.href=f.getWikiURL(t),s.title=`wiki`,s.target=`_blank`,i.replaceChildren(o,s);let c=document.createElement(`div`);c.className=`flex gap-2 text-base`;let l=n?.scrolls[r],u=document.createElement(`span`),d=document.createElement(`span`);d.className=`icon-[majesticons--scroll]`;let p=document.createElement(`span`);p.textContent=l?`${Math.floor(g.flattenCount(l))}`:`-`,p.className=`has-info`,u.replaceChildren(d,p),p.addEventListener(`mouseover`,()=>this.showPopper(p,`Scrolls in ${t}: ${l?`${l.power} Power + ${l.cursed} Cursed + ${l.dual} Dual + ${l.fragment} Fragments`:`data unavailable`}`));let v=g.scrollCount(t),y=document.createElement(`span`),b=document.createElement(`span`);b.className=`icon-[majesticons--scroll-text]`;let x=document.createElement(`span`);x.textContent=v?`${Math.floor(g.flattenCount(v))}`:`-`,x.className=`has-info`,y.replaceChildren(b,x),x.addEventListener(`mouseover`,()=>this.showPopper(x,`Scrolls in this Route: ${v?`${v.power} Power + ${v.cursed} Cursed + ${v.dual} Dual + ${v.fragment} Fragments`:`data unavailable`}`)),c.replaceChildren(u,y);let S=document.createElement(`div`);S.className=`absolute top-0 left-0 m-1 flex`;let C=document.createElement(`div`);C.className=`absolute top-0 right-0 flex`;let w=n.dlc||null;if(w!==null){let e=h.getDom(w);e.classList.add(`text-xs`,`bg-black`,`px-2`),C.appendChild(e)}if((n?.type||a.Standard)==a.Boss){let e=document.createElement(`span`);e.className=`icon-[majesticons--skull] bg-dc-red`,e.title=`Boss`,S.appendChild(e)}if(h.isDisabled(w)){let e=document.createElement(`span`);e.className=`icon-[majesticons--lock] bg-dc-red`,e.title=`Locked DLC`,S.appendChild(e)}e.replaceChildren(C,S,i,c)}),t.emit(`route-panel-reset`)}createLevelDom(e){let t=document.createElement(`div`);t.className=`border-dashed border-dc-separator py-8 relative`,e!=o.L1&&t.classList.add(`border-t-1`);let n=document.createElement(`span`);n.innerHTML=c.getName(e),n.className=`absolute left-0 top-0 text-sm font-bold text-dc-separator`,t.appendChild(n);let r=document.createElement(`div`);return r.className=`overflow-x-auto flex justify-center-safe gap-4`,f.getBiomesByLevel(e).forEach(e=>{let t=this.biomeDomElements.get(e);t&&r.appendChild(t)}),t.appendChild(r),t}createBiomeDom(e){let t=100*(598/168),n=document.createElement(`button`),r=f.getImageURL(e);n.className=`p-2 m-1 flex flex-col relative items-center justify-center gap-2 bg-center bg-no-repeat z-10 bg-[length:100%_100%] hover:bg-[length:110%_110%] transition-[background-size] duration-400 ease-out`,n.style.height=`100px`,n.style.width=`${t}px`,n.style.minWidth=`${t}px`,n.style.backgroundImage=`url(/dead-cells-route-planner/biome_placeholder.svg)`;let i=new Image;return i.src=r,i.onload=()=>n.style.backgroundImage=v(r),n}showPopper(e,t){this.popper.textContent=t,S(e,this.popper,{position:`bottom`}),this.popper.hidden=!1,e.addEventListener(`mouseleave`,()=>{this.popper.hidden=!0})}clear(){t.clear(`control-panel-reset`,this.refreshHandler),window.removeEventListener(`resize`,this.resizeHandler)}};let O=function(e){return e[e.Static=0]=`Static`,e[e.Dynamic=1]=`Dynamic`,e}({});const k=new class{viewStrategy;viewStrategyCreatorMapping=new Map([[O.Static,D],[O.Dynamic,y]]);viewStrategyRenderer=new Map;constructor(){this.loadFromStorage()}getRenderer(){if(!this.viewStrategyRenderer.has(this.viewStrategy)){let e=this.viewStrategyCreatorMapping.get(this.viewStrategy);if(e)this.viewStrategyRenderer.set(this.viewStrategy,new e);else return b}return this.viewStrategyRenderer.get(this.viewStrategy)||b}loadFromStorage(){let e=p.loadViewStrategy();e===null?this.viewStrategy=O.Static:this.viewStrategy=e}saveToStorage(){p.saveViewStrategy(this.viewStrategy)}getStrategy(){return this.viewStrategy}setStrategy(e){this.getRenderer().clear(),this.viewStrategy=e,this.saveToStorage(),t.emit(`view-update`)}getView(){return this.getRenderer().render()}};function A(e){let t=new FormData(e),n=parseInt(t.get(`boss-cell`)),r=new Set;t.getAll(`dlc`).forEach(e=>{r.add(e)});let i=t.get(`spoiler-protection`)===`on`,a=t.get(`view-strategy`)===`on`?O.Dynamic:O.Static;return{difficulty:n,dlcs:r,spoilerProtection:i,viewStrategy:a}}function j(){return{difficulty:m.getCurrent(),dlcs:new Set(h.getEnabled()),spoilerProtection:_.isEnabled(),viewStrategy:k.getStrategy()}}function M(e,t){if(e.difficulty!==t.difficulty||e.spoilerProtection!==t.spoilerProtection||e.viewStrategy!==t.viewStrategy||e.dlcs.size!==t.dlcs.size)return!0;for(let n of e.dlcs)if(!t.dlcs.has(n))return!0;return!1}function N(){let e=document.createElement(`div`);return e.className=`flex flex-col items-start gap-1 py-2 px-6`,e}function P(){let e=N(),t=document.createElement(`p`);t.className=`text-dc-gold text-sm text-left`,t.textContent=`Boss Cells`,e.appendChild(t);let n=document.createElement(`div`);return n.className=`flex flex-row flex-wrap gap-1`,m.getAll().forEach(e=>{let t=document.createElement(`label`);t.className=`flex items-center gap-2 cursor-pointer px-1`;let r=document.createElement(`input`);r.type=`radio`,r.name=`boss-cell`,r.value=e.toString(),r.className=`radio-dc`,e===m.getCurrent()&&(r.checked=!0);let i=document.createElement(`span`);i.className=`text-dc-gold-light text-sm`,i.textContent=m.getName(e),t.appendChild(r),t.appendChild(i),n.appendChild(t)}),e.appendChild(n),e}function F(){let e=N(),t=document.createElement(`p`);t.className=`text-dc-gold text-sm text-left`,t.textContent=`DLCs`,e.appendChild(t);let n=document.createElement(`div`);return n.className=`flex flex-row flex-wrap gap-1`,h.getAll().forEach(e=>{let t=document.createElement(`label`);t.className=`flex items-center gap-2 cursor-pointer px-1`;let r=document.createElement(`input`);r.type=`checkbox`,r.className=`checkbox-dc`,r.name=`dlc`,r.value=e,r.checked=h.isEnabled(e);let i=h.getDom(e);i.classList.add(`text-sm`),t.appendChild(r),t.appendChild(i),n.appendChild(t)}),e.appendChild(n),e}function I(){let e=document.createElement(`label`);e.className=`flex items-center gap-2 cursor-pointer w-fit`;let t=document.createElement(`input`);t.type=`checkbox`,t.id=`spoiler-protection`,t.name=`spoiler-protection`,t.className=`checkbox-dc`,t.checked=_.isEnabled();let n=document.createElement(`span`);return n.className=`text-dc-gold text-sm`,n.textContent=`Spoiler protection`,e.appendChild(t),e.appendChild(n),e}function L(){let e=document.createElement(`label`);e.className=`flex items-center gap-2 cursor-pointer w-fit`;let t=document.createElement(`input`);t.type=`checkbox`,t.id=`view-strategy`,t.name=`view-strategy`,t.className=`checkbox-dc`,t.checked=k.getStrategy()==O.Dynamic;let n=document.createElement(`span`);return n.className=`text-dc-gold text-sm`,n.textContent=`Advanced Mode`,e.appendChild(t),e.appendChild(n),e}function R(e){let n=document.createElement(`div`);n.className=`flex flex-row justify-between gap-1 py-2 px-6`;let r=document.createElement(`button`);r.type=`submit`,r.className=`btn-dc-primary`,r.textContent=`Apply`,r.disabled=!0;let i=document.createElement(`button`);i.type=`button`,i.className=`btn-dc-secondary`,i.textContent=`Cancel`,i.disabled=!0;let a=()=>{let t=A(e),n=j(),a=M(t,n);r.disabled=!a,i.disabled=!a};return e.addEventListener(`change`,a),t.on(`control-panel-reset`,a),i.addEventListener(`click`,()=>{let t=j();e.querySelectorAll(`input[name="boss-cell"]`).forEach(e=>{let n=e;n.checked=parseInt(n.value)===t.difficulty}),e.querySelectorAll(`input[name="dlc"]`).forEach(e=>{let n=e;n.checked=t.dlcs.has(n.value)});let n=e.querySelector(`input[name="spoiler-protection"]`);n.checked=t.spoilerProtection;let r=e.querySelector(`input[name="view-strategy"]`);r.checked=t.viewStrategy==O.Dynamic,a()}),n.appendChild(r),n.appendChild(i),n}function z(){let e=document.createElement(`div`);e.className=`p-3 banner-dc`;let n=document.createElement(`form`);n.className=`flex flex-row flex-wrap gap-2 justify-center`;let r=P(),i=F(),a=I(),o=L(),s=R(n),c=N();return c.appendChild(a),c.appendChild(o),n.appendChild(r),n.appendChild(i),n.appendChild(c),n.appendChild(s),n.addEventListener(`submit`,e=>{e.preventDefault();let r=A(n);m.set(r.difficulty),h.getAll().forEach(e=>{r.dlcs.has(e)?h.enable(e):h.disable(e)}),r.spoilerProtection?_.enable():_.disable(),r.viewStrategy?k.setStrategy(O.Dynamic):k.setStrategy(O.Static),console.log(`Settings applied:`,r),t.emit(`control-panel-reset`,r)}),e.appendChild(n),e}const B=new class{render(){let e=document.createElement(`span`);return e.textContent=`Loading...`,e.className=`flex justify-center`,e}refresh(){}clear(){}};function V(){let e=document.createElement(`main`);e.className=`flex-1`,e.appendChild(z());let n=B.render();return e.appendChild(n),t.on(`view-update`,()=>{let t=k.getView();e.replaceChild(t,n),n=t}),t.emit(`view-update`),e}function H(){let e=document.createElement(`footer`);return e.className=`text-center bg-dc-footer py-6`,e.innerHTML=`
    <div class="mx-auto text-dc-gray">
      <p class="text-sm">&copy; 2025 Dead Cells Route Planner</p>
      <p class="text-sm">Fan-made tool for Dead Cells by Motion Twin</p>
    </div>
  `,e}var U=document.querySelector(`#app`),W=document.createElement(`div`);W.className=`flex flex-col min-h-screen bg-dc-dark`,W.appendChild(e()),W.appendChild(V()),W.appendChild(H()),U.appendChild(W);